<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>التصاريح الأمنية - مسار</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <div id="header-container"></div>
    
    <!-- Sidebar -->
    <div id="sidebar-container"></div>
    
    <!-- Main Content -->
    <main class="main-content">
        <div class="content-wrapper">
            <div class="page-header">
                <h1><i class="fas fa-shield-alt"></i> التصاريح الأمنية</h1>
                <p>إدارة ومراقبة التصاريح الأمنية والوصول للنظام</p>
            </div>
            
            <!-- Security Overview -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-shield-check"></i>
                    </div>
                    <div class="card-content">
                        <h3>تصاريح نشطة</h3>
                        <span class="card-number">45</span>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="card-content">
                        <h3>في الانتظار</h3>
                        <span class="card-number">12</span>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="card-content">
                        <h3>تصاريح منتهية</h3>
                        <span class="card-number">8</span>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-ban"></i>
                    </div>
                    <div class="card-content">
                        <h3>تصاريح محظورة</h3>
                        <span class="card-number">3</span>
                    </div>
                </div>
            </div>
            
            <!-- New Permit Form -->
            <div class="form-container">
                <h2><i class="fas fa-plus-circle"></i> إصدار تصريح أمني جديد</h2>
                <form id="newPermitForm">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label>اسم المستخدم *</label>
                            <input type="text" class="form-control" name="userName" required placeholder="أدخل اسم المستخدم">
                        </div>
                        <div class="form-group">
                            <label>الرقم الوظيفي</label>
                            <input type="text" class="form-control" name="employeeId" placeholder="EMP-001">
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label>نوع التصريح *</label>
                            <select class="form-control" name="permitType" required>
                                <option value="">اختر نوع التصريح</option>
                                <option value="admin">إداري كامل</option>
                                <option value="manager">مدير قسم</option>
                                <option value="employee">موظف</option>
                                <option value="viewer">مشاهد فقط</option>
                                <option value="guest">ضيف مؤقت</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>مستوى الأمان *</label>
                            <select class="form-control" name="securityLevel" required>
                                <option value="">اختر مستوى الأمان</option>
                                <option value="1">المستوى 1 - أساسي</option>
                                <option value="2">المستوى 2 - متوسط</option>
                                <option value="3">المستوى 3 - عالي</option>
                                <option value="4">المستوى 4 - سري</option>
                                <option value="5">المستوى 5 - سري للغاية</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label>تاريخ البداية *</label>
                            <input type="date" class="form-control" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label>تاريخ الانتهاء *</label>
                            <input type="date" class="form-control" name="endDate" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>الصلاحيات المسموحة</label>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 0.5rem;">
                            <label class="checkbox-label">
                                <input type="checkbox" name="permissions" value="read"> قراءة البيانات
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="permissions" value="write"> كتابة البيانات
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="permissions" value="delete"> حذف البيانات
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="permissions" value="admin"> إدارة المستخدمين
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="permissions" value="reports"> عرض التقارير
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="permissions" value="settings"> إعدادات النظام
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>سبب إصدار التصريح *</label>
                        <textarea class="form-control" name="reason" rows="3" required placeholder="أدخل سبب إصدار التصريح..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>ملاحظات أمنية</label>
                        <textarea class="form-control" name="securityNotes" rows="2" placeholder="أي ملاحظات أمنية إضافية..."></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 2rem;">
                        <button type="button" class="btn btn-secondary" onclick="resetPermitForm()">
                            <i class="fas fa-undo"></i> إعادة تعيين
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-shield-alt"></i> إصدار التصريح
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Permits Table -->
            <div class="form-container">
                <h2><i class="fas fa-list"></i> قائمة التصاريح الأمنية</h2>
                
                <!-- Filter Section -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 1rem; align-items: end; margin-bottom: 1rem;">
                    <div class="form-group">
                        <label>البحث</label>
                        <input type="text" class="form-control" placeholder="اسم المستخدم أو رقم التصريح..." id="searchPermits">
                    </div>
                    <div class="form-group">
                        <label>نوع التصريح</label>
                        <select class="form-control" id="permitTypeFilter">
                            <option value="">جميع الأنواع</option>
                            <option value="admin">إداري كامل</option>
                            <option value="manager">مدير قسم</option>
                            <option value="employee">موظف</option>
                            <option value="viewer">مشاهد فقط</option>
                            <option value="guest">ضيف مؤقت</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>الحالة</label>
                        <select class="form-control" id="statusFilter">
                            <option value="">جميع الحالات</option>
                            <option value="active">نشط</option>
                            <option value="pending">في الانتظار</option>
                            <option value="expired">منتهي</option>
                            <option value="blocked">محظور</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="filterPermits()">
                        <i class="fas fa-search"></i> بحث
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>رقم التصريح</th>
                                <th>المستخدم</th>
                                <th>نوع التصريح</th>
                                <th>مستوى الأمان</th>
                                <th>تاريخ الإصدار</th>
                                <th>تاريخ الانتهاء</th>
                                <th>الحالة</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SEC-2024-001</strong></td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <div class="user-avatar">أ.م</div>
                                        <div>
                                            <div>أحمد محمد</div>
                                            <small style="color: var(--primary-gray);">EMP-001</small>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="permit-admin">إداري كامل</span></td>
                                <td><span class="security-level-5">المستوى 5</span></td>
                                <td>2024-01-01</td>
                                <td>2024-12-31</td>
                                <td><span class="status-active">نشط</span></td>
                                <td>
                                    <button class="btn-icon" onclick="viewPermit('SEC-2024-001')" data-tooltip="عرض">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon" onclick="editPermit('SEC-2024-001')" data-tooltip="تعديل">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-icon btn-warning" onclick="suspendPermit('SEC-2024-001')" data-tooltip="تعليق">
                                        <i class="fas fa-pause"></i>
                                    </button>
                                    <button class="btn-icon btn-danger" onclick="revokePermit('SEC-2024-001')" data-tooltip="إلغاء">
                                        <i class="fas fa-ban"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>SEC-2024-002</strong></td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <div class="user-avatar">س.أ</div>
                                        <div>
                                            <div>سارة أحمد</div>
                                            <small style="color: var(--primary-gray);">EMP-002</small>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="permit-manager">مدير قسم</span></td>
                                <td><span class="security-level-3">المستوى 3</span></td>
                                <td>2024-01-15</td>
                                <td>2024-07-15</td>
                                <td><span class="status-active">نشط</span></td>
                                <td>
                                    <button class="btn-icon" onclick="viewPermit('SEC-2024-002')" data-tooltip="عرض">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon" onclick="editPermit('SEC-2024-002')" data-tooltip="تعديل">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-icon btn-warning" onclick="suspendPermit('SEC-2024-002')" data-tooltip="تعليق">
                                        <i class="fas fa-pause"></i>
                                    </button>
                                    <button class="btn-icon btn-danger" onclick="revokePermit('SEC-2024-002')" data-tooltip="إلغاء">
                                        <i class="fas fa-ban"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>SEC-2024-003</strong></td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <div class="user-avatar">م.ع</div>
                                        <div>
                                            <div>محمد عبدالله</div>
                                            <small style="color: var(--primary-gray);">EMP-003</small>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="permit-employee">موظف</span></td>
                                <td><span class="security-level-2">المستوى 2</span></td>
                                <td>2024-01-10</td>
                                <td>2024-01-25</td>
                                <td><span class="status-expired">منتهي</span></td>
                                <td>
                                    <button class="btn-icon" onclick="viewPermit('SEC-2024-003')" data-tooltip="عرض">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon btn-success" onclick="renewPermit('SEC-2024-003')" data-tooltip="تجديد">
                                        <i class="fas fa-redo"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
    
    <script src="assets/js/components.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        // Page-specific JavaScript
        document.getElementById('newPermitForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const permitData = {
                userName: formData.get('userName'),
                employeeId: formData.get('employeeId'),
                permitType: formData.get('permitType'),
                securityLevel: formData.get('securityLevel'),
                startDate: formData.get('startDate'),
                endDate: formData.get('endDate'),
                reason: formData.get('reason'),
                securityNotes: formData.get('securityNotes'),
                permissions: formData.getAll('permissions')
            };
            
            showLoading();
            
            setTimeout(() => {
                hideLoading();
                const permitNumber = 'SEC-2024-' + String(Date.now()).slice(-3);
                showNotification(`تم إصدار التصريح الأمني بنجاح - رقم التصريح: ${permitNumber}`, 'success');
                this.reset();
            }, 2000);
        });
        
        function resetPermitForm() {
            document.getElementById('newPermitForm').reset();
            showNotification('تم إعادة تعيين النموذج', 'info');
        }
        
        function viewPermit(permitId) {
            showNotification(`عرض تفاصيل التصريح ${permitId}`, 'info');
        }
        
        function editPermit(permitId) {
            showNotification(`تعديل التصريح ${permitId}`, 'info');
        }
        
        function suspendPermit(permitId) {
            if (confirm(`هل أنت متأكد من تعليق التصريح ${permitId}؟`)) {
                showLoading();
                setTimeout(() => {
                    hideLoading();
                    showNotification(`تم تعليق التصريح ${permitId}`, 'success');
                }, 1000);
            }
        }
        
        function revokePermit(permitId) {
            const reason = prompt('يرجى إدخال سبب إلغاء التصريح:');
            if (reason) {
                showLoading();
                setTimeout(() => {
                    hideLoading();
                    showNotification(`تم إلغاء التصريح ${permitId}`, 'success');
                }, 1500);
            }
        }
        
        function renewPermit(permitId) {
            if (confirm(`هل تريد تجديد التصريح ${permitId}؟`)) {
                showLoading();
                setTimeout(() => {
                    hideLoading();
                    showNotification(`تم تجديد التصريح ${permitId}`, 'success');
                }, 1500);
            }
        }
        
        function filterPermits() {
            showLoading();
            setTimeout(() => {
                hideLoading();
                showNotification('تم تطبيق المرشحات', 'success');
            }, 1000);
        }
    </script>
    
    <style>
        .user-avatar {
            width: 35px;
            height: 35px;
            background: var(--primary-yellow);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-gray);
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .permit-admin {
            background: #dc3545;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .permit-manager {
            background: #ffc107;
            color: #333;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .permit-employee {
            background: #28a745;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .permit-viewer {
            background: #6c757d;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .permit-guest {
            background: #17a2b8;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .security-level-1 {
            color: #28a745;
            font-weight: 600;
        }
        
        .security-level-2 {
            color: #ffc107;
            font-weight: 600;
        }
        
        .security-level-3 {
            color: #fd7e14;
            font-weight: 600;
        }
        
        .security-level-4 {
            color: #dc3545;
            font-weight: 600;
        }
        
        .security-level-5 {
            color: #6f42c1;
            font-weight: 600;
        }
        
        .status-active {
            color: #28a745;
            font-weight: 600;
        }
        
        .status-pending {
            color: #ffc107;
            font-weight: 600;
        }
        
        .status-expired {
            color: #dc3545;
            font-weight: 600;
        }
        
        .status-blocked {
            color: #6c757d;
            font-weight: 600;
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }
        
        .checkbox-label:hover {
            background: var(--light-yellow);
        }
        
        .checkbox-label input[type="checkbox"] {
            margin: 0;
        }
        
        .btn-icon {
            background: none;
            border: none;
            padding: 0.5rem;
            margin: 0 0.25rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--primary-gray);
        }
        
        .btn-icon:hover {
            background: var(--light-yellow);
            color: var(--dark-gray);
        }
        
        .btn-warning {
            color: #ffc107;
        }
        
        .btn-warning:hover {
            background: #ffc107;
            color: #333;
        }
        
        .btn-success {
            color: #28a745;
        }
        
        .btn-success:hover {
            background: #28a745;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc3545;
            color: var(--white);
        }
        
        @media (max-width: 768px) {
            .form-container > div[style*="grid-template-columns"] {
                grid-template-columns: 1fr !important;
            }
        }
    </style>
</body>
</html>